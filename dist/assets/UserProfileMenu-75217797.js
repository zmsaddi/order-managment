import{u as w,r as c,a as h,j as b,G as M,b as k,o as u,d as p,f as e,t as i,g as _,w as d,k as C,h as x,T as z}from"./vendor-24875fe8.js";import{_ as A,a as B}from"./index-38f5e110.js";const U={name:"UserProfileMenu",props:{user:{type:Object,required:!0}},setup(m){const t=w(),o=c(!1),s=c(null),a=c(null),g=h(()=>["admin","sales_manager"].includes(m.user.role)),r=()=>{o.value=!o.value},n=()=>{o.value=!1},v=async()=>{try{await B.logout(),localStorage.removeItem("user"),t.push({name:"login"})}catch(l){console.error("خطأ في تسجيل الخروج:",l)}},y=async()=>{n(),await v()},f=l=>{o.value&&a.value&&s.value&&!a.value.contains(l.target)&&!s.value.contains(l.target)&&n()};return b(()=>{document.addEventListener("mousedown",f)}),M(()=>{document.removeEventListener("mousedown",f)}),{isOpen:o,isAdmin:g,toggleMenu:r,closeMenu:n,logout:v,logoutAndCloseMenu:y,profileButton:s,profileMenu:a}}},O={class:"relative"},V={class:"text-sm text-gray-600 ml-2 hidden sm:block"},j={class:"w-9 h-9 rounded-full bg-sky-600 flex items-center justify-center text-white shadow-sm hover:bg-sky-700 transition-colors"},E={key:0,class:"absolute left-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50",ref:"profileMenu"},L={class:"py-2 px-4 border-b border-gray-100"},N={class:"text-sm font-medium text-gray-900 text-center"},P={class:"text-xs text-gray-500 text-center"},S={class:"py-1"},H={class:"py-1 border-t border-gray-100"};function I(m,t,o,s,a,g){const r=k("router-link");return u(),p("div",O,[e("button",{onClick:t[0]||(t[0]=(...n)=>s.toggleMenu&&s.toggleMenu(...n)),class:"flex items-center focus:outline-none",ref:"profileButton"},[e("span",V,i(o.user.name),1),e("div",j,i(o.user.name?o.user.name.charAt(0):"U"),1)],512),_(z,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:d(()=>[s.isOpen?(u(),p("div",E,[e("div",L,[e("p",N,i(o.user.name),1),e("p",P,i(o.user.email),1)]),e("div",S,[_(r,{to:"/profile",class:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",onClick:s.closeMenu},{default:d(()=>t[2]||(t[2]=[e("span",{class:"ml-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z","clip-rule":"evenodd"})])],-1),e("span",null,"الملف الشخصي",-1)])),_:1,__:[2]},8,["onClick"]),s.isAdmin?(u(),C(r,{key:0,to:"/users",class:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors",onClick:s.closeMenu},{default:d(()=>t[3]||(t[3]=[e("span",{class:"ml-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"})])],-1),e("span",null,"المستخدمين",-1)])),_:1,__:[3]},8,["onClick"])):x("",!0)]),e("div",H,[e("button",{onClick:t[1]||(t[1]=(...n)=>s.logoutAndCloseMenu&&s.logoutAndCloseMenu(...n)),class:"flex w-full items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors text-right"},t[4]||(t[4]=[e("span",{class:"ml-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z","clip-rule":"evenodd"})])],-1),e("span",null,"تسجيل الخروج",-1)]))])],512)):x("",!0)]),_:1})])}const D=A(U,[["render",I],["__scopeId","data-v-fd6bb654"]]);export{D as U};
