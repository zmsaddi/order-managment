import{e as z,r as m,m as P,c as q,u as x,a as B,b as k,o as c,d as p,f as s,g as f,w,n as b,h as S,F as J,i as R,j as T,k as H,p as E,l as j,q as O,v as L,t as $,s as F,x as D,_ as g,y as K}from"./vendor-24875fe8.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function o(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=o(a);fetch(a.href,l)}})();var G=!1;/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */const W=Symbol();var C;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(C||(C={}));function Q(){const t=z(!0),e=t.run(()=>m({}));let o=[],r=[];const a=P({install(l){a._a=l,l.provide(W,a),l.config.globalProperties.$pinia=a,r.forEach(n=>o.push(n)),r=[]},use(l){return!this._a&&!G?r.push(l):o.push(l),this},_p:o,_a:null,_e:t,_s:new Map,state:e});return a}const v={supabaseUrl:"https://mrocuyajltnvhiiigwqb.supabase.co",supabaseKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1yb2N1eWFqbHRudmhpaWlnd3FiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg5ODk4NTQsImV4cCI6MjA2NDU2NTg1NH0.zzFEJKO6rHm5GypGR4QSFBFMwCBibdgOlkzL5V08Rf4"},X=v.supabaseUrl,Z=v.supabaseKey,u=q(X,Z),M={async login(t,e){const{data:o,error:r}=await u.auth.signInWithPassword({email:t,password:e});if(r)throw r;const{data:a,error:l}=await u.from("users").select("*").eq("id",o.user.id).single();if(l)if(l.code==="PGRST116"){const{count:n,error:i}=await u.from("users").select("*",{count:"exact",head:!0});if(i)throw i;const h=n===0?"admin":"representative",{data:d,error:_}=await u.from("users").insert([{id:o.user.id,email:o.user.email,name:o.user.email.split("@")[0],role:h,status:"active"}]).select().single();if(_)throw _;const N=d;return localStorage.setItem("user",JSON.stringify(N)),{user:d,session:o.session}}else throw l;return localStorage.setItem("user",JSON.stringify(a)),{user:a,session:o.session}},async logout(){const{error:t}=await u.auth.signOut();if(t)throw t;localStorage.removeItem("user")},async createUser(t){const e=JSON.parse(localStorage.getItem("user")||"{}");if(!["admin","sales_manager"].includes(e.role))throw new Error("ليس لديك صلاحية لإنشاء مستخدمين جدد");try{const o=t.email,r=t.password,{data:a,error:l}=await u.auth.signUp({email:o,password:r,options:{data:{name:t.name,role:t.role,email:o}}});if(l)throw l;const{data:n,error:i}=await u.from("users").insert([{id:a.user.id,email:o,name:t.name,role:t.role,phone:t.phone,address:t.address,status:t.status||"active"}]).select().single();if(i)throw i;return{user:n}}catch(o){throw console.error("خطأ في إنشاء المستخدم:",o),o}},async updateUser(t,e){const o=JSON.parse(localStorage.getItem("user")||"{}");if(!["admin","sales_manager"].includes(o.role)&&o.id!==t)throw new Error("ليس لديك صلاحية لتحديث بيانات هذا المستخدم");const{data:r,error:a}=await u.from("users").update({name:e.name,role:e.role,phone:e.phone,address:e.address,status:e.status,updated_at:new Date}).eq("id",t).select().single();if(a)throw a;return o.id===t&&localStorage.setItem("user",JSON.stringify(r)),{user:r}},async deleteUser(t){const e=JSON.parse(localStorage.getItem("user")||"{}");if(!["admin","sales_manager"].includes(e.role))throw new Error("ليس لديك صلاحية لحذف المستخدمين");const{data:o,error:r}=await u.from("users").select("role").eq("id",t).single();if(r)throw r;if(o.role==="admin")throw new Error("لا يمكن حذف المدير العام");if(e.role==="sales_manager"&&o.role==="sales_manager")throw new Error("لا يمكن لمدير المبيعات حذف مدير مبيعات آخر");const{error:a}=await u.from("users").delete().eq("id",t);if(a)throw a;return{success:!0,message:"تم حذف المستخدم من النظام. لحذفه بشكل كامل من نظام المصادقة، يرجى استخدام لوحة تحكم Supabase."}},async resetPassword(t,e){const o=JSON.parse(localStorage.getItem("user")||"{}");if(!["admin","sales_manager"].includes(o.role))throw new Error("ليس لديك صلاحية لإعادة تعيين كلمات المرور");const{error:r}=await u.auth.admin.updateUserById(t,{password:e});if(r)throw r;return{success:!0}},async updateUserPassword(t,e){const o=JSON.parse(localStorage.getItem("user")||"{}");if(!["admin","sales_manager"].includes(o.role))throw new Error("ليس لديك صلاحية لتحديث كلمات المرور");if(e.length<6)throw new Error("يجب أن تكون كلمة المرور 6 أحرف على الأقل");try{const{error:r}=await u.auth.admin.updateUserById(t,{password:e});if(r)throw r;return{success:!0,error:null}}catch(r){return console.error("خطأ في تحديث كلمة المرور:",r),{success:!1,error:r}}},async checkAuth(){const{data:{session:t}}=await u.auth.getSession();if(!t)return{user:null,session:null};const{data:e,error:o}=await u.from("users").select("*").eq("id",t.user.id).single();return o?(await this.logout(),{user:null,session:null}):(localStorage.setItem("user",JSON.stringify(e)),{user:e,session:t})},async createDefaultAdmin(){const{count:t,error:e}=await u.from("users").select("*",{count:"exact",head:!0});if(e)throw e;if(t>0)return{success:!1,message:"يوجد مستخدمين بالفعل في النظام"};const{data:o,error:r}=await u.auth.admin.createUser({email:"msaddizakariya@gmail.com",password:"Spain@2025",email_confirm:!0});if(r)throw r;const{data:a,error:l}=await u.from("users").insert([{id:o.user.id,email:"msaddizakariya@gmail.com",name:"مدير النظام",role:"admin",status:"active"}]).select().single();if(l)throw await u.auth.admin.deleteUser(o.user.id),l;return localStorage.setItem("user",JSON.stringify(a)),{success:!0,user:a}}},I=(t,e)=>{const o=t.__vccOpts||t;for(const[r,a]of e)o[r]=a;return o},Y={name:"SidebarMenu",props:{user:{type:Object,required:!0},showMobileSidebar:{type:Boolean,default:!1}},emits:["toggle-sidebar"],setup(t,{emit:e}){const o=x(),r=m(!1),a=B(()=>["admin","sales_manager"].includes(t.user.role)),l=()=>{r.value=!r.value},n=async()=>{try{await M.logout(),localStorage.removeItem("user"),o.push({name:"login"})}catch(h){console.error("خطأ في تسجيل الخروج:",h)}};return{isAdmin:a,logout:n,showMobileMenu:r,toggleMobileMenu:l,logoutMobile:async()=>{l(),await n()}}}},ee={class:"bg-sky-800 text-white w-64 flex-shrink-0 hidden md:block"},re={class:"mt-4"},se={class:"space-y-1"},te={key:0,class:"fixed inset-0 bg-gray-800 bg-opacity-75 z-50 md:hidden"},oe={class:"bg-sky-800 text-white h-full w-64 overflow-y-auto"},ae={class:"flex justify-between items-center p-4 border-b border-sky-700"},ne={class:"mt-4"},le={class:"space-y-1"},ie={class:"fixed bottom-4 left-4 md:hidden z-40"};function ue(t,e,o,r,a,l){const n=k("router-link");return c(),p(J,null,[s("aside",ee,[e[5]||(e[5]=s("div",{class:"p-4 border-b border-sky-700"},[s("h1",{class:"text-xl font-bold"},"نظام إدارة الطلبات")],-1)),s("nav",re,[s("ul",se,[s("li",null,[f(n,{to:"/dashboard",class:b(["flex items-center px-4 py-3 hover:bg-sky-700 transition-colors",{"bg-sky-700":t.$route.path==="/dashboard"}])},{default:w(()=>e[2]||(e[2]=[s("span",{class:"ml-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})])],-1),s("span",null,"لوحة التحكم",-1)])),_:1,__:[2]},8,["class"])]),s("li",null,[f(n,{to:"/orders",class:b(["flex items-center px-4 py-3 hover:bg-sky-700 transition-colors",{"bg-sky-700":t.$route.path==="/orders"}])},{default:w(()=>e[3]||(e[3]=[s("span",{class:"ml-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z","clip-rule":"evenodd"})])],-1),s("span",null,"الطلبات",-1)])),_:1,__:[3]},8,["class"])]),s("li",null,[f(n,{to:"/reports",class:b(["flex items-center px-4 py-3 hover:bg-sky-700 transition-colors",{"bg-sky-700":t.$route.path==="/reports"}])},{default:w(()=>e[4]||(e[4]=[s("span",{class:"ml-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 0l-2 2a1 1 0 101.414 1.414L8 10.414l1.293 1.293a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1),s("span",null,"التقارير",-1)])),_:1,__:[4]},8,["class"])])])])]),r.showMobileMenu?(c(),p("div",te,[s("div",oe,[s("div",ae,[e[7]||(e[7]=s("h1",{class:"text-xl font-bold"},"نظام إدارة الطلبات",-1)),s("button",{onClick:e[0]||(e[0]=(...i)=>r.toggleMobileMenu&&r.toggleMobileMenu(...i)),class:"text-white focus:outline-none"},e[6]||(e[6]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),s("nav",ne,[s("ul",le,[s("li",null,[f(n,{to:"/dashboard",onClick:r.toggleMobileMenu,class:b(["flex items-center px-4 py-3 hover:bg-sky-700 transition-colors",{"bg-sky-700":t.$route.path==="/dashboard"}])},{default:w(()=>e[8]||(e[8]=[s("span",{class:"ml-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})])],-1),s("span",null,"لوحة التحكم",-1)])),_:1,__:[8]},8,["onClick","class"])]),s("li",null,[f(n,{to:"/orders",onClick:r.toggleMobileMenu,class:b(["flex items-center px-4 py-3 hover:bg-sky-700 transition-colors",{"bg-sky-700":t.$route.path==="/orders"}])},{default:w(()=>e[9]||(e[9]=[s("span",{class:"ml-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z","clip-rule":"evenodd"})])],-1),s("span",null,"الطلبات",-1)])),_:1,__:[9]},8,["onClick","class"])]),s("li",null,[f(n,{to:"/reports",onClick:r.toggleMobileMenu,class:b(["flex items-center px-4 py-3 hover:bg-sky-700 transition-colors",{"bg-sky-700":t.$route.path==="/reports"}])},{default:w(()=>e[10]||(e[10]=[s("span",{class:"ml-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M3 3a1 1 0 000 2v8a2 2 0 002 2h2.586l-1.293 1.293a1 1 0 101.414 1.414L10 15.414l2.293 2.293a1 1 0 001.414-1.414L12.414 15H15a2 2 0 002-2V5a1 1 0 100-2H3zm11.707 4.707a1 1 0 00-1.414-1.414L10 9.586 8.707 8.293a1 1 0 00-1.414 0l-2 2a1 1 0 101.414 1.414L8 10.414l1.293 1.293a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1),s("span",null,"التقارير",-1)])),_:1,__:[10]},8,["onClick","class"])])])])])])):S("",!0),s("div",ie,[s("button",{onClick:e[1]||(e[1]=(...i)=>r.toggleMobileMenu&&r.toggleMobileMenu(...i)),class:"bg-sky-600 text-white p-3 rounded-full shadow-lg hover:bg-sky-700 focus:outline-none"},e[11]||(e[11]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)]))])],64)}const ce=I(Y,[["render",ue]]);const de={name:"App",components:{SidebarMenu:ce},setup(){const t=x(),e=R(),o=m({}),r=m(!1),a=m(!1),l=m(""),n=d=>{l.value=d},i=()=>{a.value=!a.value},h=async()=>{try{const{user:d,session:_}=await M.checkAuth();d?(o.value=d,r.value=!0,localStorage.setItem("user",JSON.stringify(d)),(e.path==="/login"||e.path==="/")&&t.push("/dashboard")):(r.value=!1,localStorage.removeItem("user"),e.path!=="/login"&&e.path!=="/confirm-account"&&t.push("/login"))}catch(d){console.error("خطأ في التحقق من المصادقة:",d),r.value=!1,localStorage.removeItem("user"),t.push("/login")}};return E("user",o),E("toggleSidebar",i),T(()=>{h()}),{user:o,isAuthenticated:r,showMobileSidebar:a,toggleSidebar:i,pageTitle:l,updatePageTitle:n}}},me={id:"app"},pe={key:0,class:"min-h-screen bg-gray-50"},he={class:"flex h-screen overflow-hidden"},ge={class:"flex-1 flex flex-col overflow-hidden"},fe={key:0,class:"fixed inset-0 z-50 md:hidden"},we={class:"absolute inset-y-0 right-0 w-64 bg-sky-800 text-white"},be={class:"p-4 border-b border-sky-700 flex justify-between items-center"},ve={key:1};function _e(t,e,o,r,a,l){const n=k("SidebarMenu"),i=k("router-view");return c(),p("div",me,[r.isAuthenticated?(c(),p("div",pe,[s("div",he,[f(n,{user:r.user,class:"hidden md:block"},null,8,["user"]),s("div",ge,[(c(),H(i,{onUpdatePageTitle:r.updatePageTitle,key:t.$route.fullPath},null,8,["onUpdatePageTitle"]))])]),r.showMobileSidebar?(c(),p("div",fe,[s("div",{class:"absolute inset-0 bg-black opacity-50",onClick:e[0]||(e[0]=(...h)=>r.toggleSidebar&&r.toggleSidebar(...h))}),s("div",we,[s("div",be,[e[3]||(e[3]=s("h1",{class:"text-xl font-bold"},"نظام إدارة الطلبات",-1)),s("button",{onClick:e[1]||(e[1]=(...h)=>r.toggleSidebar&&r.toggleSidebar(...h))},e[2]||(e[2]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),f(n,{user:r.user,mobile:"",onItemClick:r.toggleSidebar},null,8,["user","onItemClick"])])])):S("",!0)])):(c(),p("div",ve,[f(i)]))])}const ye=I(de,[["render",_e]]);let y=null;const ke=()=>(y||(y=q(v.supabaseUrl,v.supabaseKey)),y),U=ke(),xe={name:"LoginView",setup(){const t=x(),e=m(""),o=m(""),r=m(!1),a=m("");return{email:e,password:o,loading:r,errorMessage:a,handleLogin:async()=>{try{r.value=!0,a.value="";const n=await M.login(e.value,o.value);localStorage.setItem("user",JSON.stringify(n.user)),t.push({name:"dashboard"})}catch(n){console.error("خطأ في تسجيل الدخول:",n),a.value="فشل تسجيل الدخول. يرجى التحقق من البريد الإلكتروني وكلمة المرور."}finally{r.value=!1}}}}},Se={class:"min-h-screen flex items-center justify-center bg-gradient-to-b from-sky-100 to-white"},Me={class:"card w-full max-w-md p-6"},Ie={class:"form-group"},Ae={class:"form-group"},Ee={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative text-center mb-4"},Oe=["disabled"],Le={key:0},Ce={key:1};function Ue(t,e,o,r,a,l){return c(),p("div",Se,[s("div",Me,[e[5]||(e[5]=s("div",{class:"text-center mb-6"},[s("h1",{class:"text-2xl font-bold text-sky-700 mb-2"},"نظام إدارة الطلبات"),s("p",{class:"text-gray-600"},"تسجيل الدخول للوصول إلى النظام")],-1)),s("form",{onSubmit:e[2]||(e[2]=j((...n)=>r.handleLogin&&r.handleLogin(...n),["prevent"])),class:"space-y-4"},[s("div",Ie,[e[3]||(e[3]=s("label",{for:"email",class:"form-label"},"البريد الإلكتروني",-1)),O(s("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=n=>r.email=n),class:"form-input",placeholder:"أدخل البريد الإلكتروني",required:""},null,512),[[L,r.email]])]),s("div",Ae,[e[4]||(e[4]=s("label",{for:"password",class:"form-label"},"كلمة المرور",-1)),O(s("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=n=>r.password=n),class:"form-input",placeholder:"أدخل كلمة المرور",required:""},null,512),[[L,r.password]])]),r.errorMessage?(c(),p("div",Ee,$(r.errorMessage),1)):S("",!0),s("button",{type:"submit",class:"btn btn-primary w-full py-3",disabled:r.loading},[r.loading?(c(),p("span",Le,"جاري تسجيل الدخول...")):(c(),p("span",Ce,"تسجيل الدخول"))],8,Oe)],32)])])}const qe=I(xe,[["render",Ue]]),Ve=[{path:"/",redirect:"/login"},{path:"/login",name:"login",component:qe,meta:{requiresAuth:!1}},{path:"/confirm-account",name:"confirm-account",component:()=>g(()=>import("./ConfirmAccountView-bc1617a3.js"),["./ConfirmAccountView-bc1617a3.js","./vendor-24875fe8.js","./ConfirmAccountView-442d7f98.css"],import.meta.url),meta:{requiresAuth:!1}},{path:"/dashboard",name:"dashboard",component:()=>g(()=>import("./DashboardView-7e380588.js"),["./DashboardView-7e380588.js","./UserProfileMenu-75217797.js","./vendor-24875fe8.js","./UserProfileMenu-a919ee82.css","./formatters-b73e5c82.js","./DashboardView-e3b0c442.css"],import.meta.url),meta:{requiresAuth:!0}},{path:"/users",name:"users",component:()=>g(()=>import("./UsersView-e40b16ef.js"),["./UsersView-e40b16ef.js","./vendor-24875fe8.js","./UsersView-1dd08f05.css"],import.meta.url),meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/orders",name:"orders",component:()=>g(()=>import("./OrdersView-dbfd608d.js"),["./OrdersView-dbfd608d.js","./vendor-24875fe8.js","./formatters-b73e5c82.js","./OrdersView-755ab800.css"],import.meta.url),meta:{requiresAuth:!0}},{path:"/orders/create",name:"create-order",component:()=>g(()=>import("./CreateOrderView-6b213305.js"),["./CreateOrderView-6b213305.js","./vendor-24875fe8.js","./formatters-b73e5c82.js","./CreateOrderView-c3e9983f.css"],import.meta.url),meta:{requiresAuth:!0}},{path:"/orders/:id",name:"order-details",component:()=>g(()=>import("./OrderDetailsView-5962337d.js").then(t=>t.O),["./OrderDetailsView-5962337d.js","./vendor-24875fe8.js","./UserProfileMenu-75217797.js","./UserProfileMenu-a919ee82.css","./formatters-b73e5c82.js","./OrderDetailsView-5de0612f.css"],import.meta.url),meta:{requiresAuth:!0}},{path:"/orders/edit/:id",name:"edit-order",component:()=>g(()=>import("./EditOrderView-066f9156.js"),["./EditOrderView-066f9156.js","./vendor-24875fe8.js","./formatters-b73e5c82.js","./EditOrderView-90570e78.css"],import.meta.url),meta:{requiresAuth:!0}},{path:"/reports",name:"reports",component:()=>g(()=>import("./ReportsView-d18f0c12.js"),["./ReportsView-d18f0c12.js","./vendor-24875fe8.js","./formatters-b73e5c82.js","./ReportsView-c211b40a.css"],import.meta.url),meta:{requiresAuth:!0}},{path:"/profile",name:"profile",component:()=>g(()=>import("./ProfileView-476d0940.js"),["./ProfileView-476d0940.js","./vendor-24875fe8.js"],import.meta.url),meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",redirect:"/dashboard"}],V=F({history:D(),routes:Ve});V.beforeEach(async(t,e,o)=>{try{const{data:{session:r}}=await U.auth.getSession(),a=t.matched.some(n=>n.meta.requiresAuth),l=t.matched.some(n=>n.meta.requiresAdmin);if(a&&!r){o({name:"login"});return}if(r&&t.name==="login"){o({name:"dashboard"});return}if(l&&r){const{data:n,error:i}=await U.from("users").select("role").eq("id",r.user.id).single();if(i||!n||!["admin","sales_manager"].includes(n.role)){o({name:"dashboard"});return}}o()}catch(r){console.error("خطأ في التوجيه:",r),t.meta.requiresAuth?o({name:"login"}):o()}});const A=K(ye);A.use(Q());A.use(V);A.mount("#app");export{ce as S,I as _,M as a,U as s};
